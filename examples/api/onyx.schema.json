{
  "tables": [
    {
      "name": "AuditLog",
      "fields": [
        {
          "name": "action",
          "type": "String",
          "nullable": true
        },
        {
          "name": "actorId",
          "type": "String",
          "nullable": false
        },
        {
          "name": "changes",
          "type": "EmbeddedObject",
          "nullable": false
        },
        {
          "name": "dateTime",
          "type": "Timestamp",
          "nullable": false
        },
        {
          "name": "errorCode",
          "type": "String",
          "nullable": false
        },
        {
          "name": "errorMessage",
          "type": "String",
          "nullable": false
        },
        {
          "name": "id",
          "type": "String",
          "nullable": false,
          "primaryKey": true
        },
        {
          "name": "metadata",
          "type": "EmbeddedObject",
          "nullable": false
        },
        {
          "name": "requestId",
          "type": "String",
          "nullable": false
        },
        {
          "name": "resource",
          "type": "String",
          "nullable": false
        },
        {
          "name": "status",
          "type": "String",
          "nullable": true
        },
        {
          "name": "targetId",
          "type": "String",
          "nullable": false
        },
        {
          "name": "tenantId",
          "type": "String",
          "nullable": true
        }
      ]
    },
    {
      "name": "Permission",
      "fields": [
        {
          "name": "createdAt",
          "type": "Timestamp",
          "nullable": false
        },
        {
          "name": "deletedAt",
          "type": "Timestamp",
          "nullable": false
        },
        {
          "name": "description",
          "type": "String",
          "nullable": true
        },
        {
          "name": "id",
          "type": "String",
          "nullable": false,
          "primaryKey": true
        },
        {
          "name": "name",
          "type": "String",
          "nullable": false
        },
        {
          "name": "updatedAt",
          "type": "Timestamp",
          "nullable": false
        }
      ]
    },
    {
      "name": "Role",
      "fields": [
        {
          "name": "createdAt",
          "type": "Timestamp",
          "nullable": false
        },
        {
          "name": "deletedAt",
          "type": "Timestamp",
          "nullable": false
        },
        {
          "name": "description",
          "type": "String",
          "nullable": true
        },
        {
          "name": "id",
          "type": "String",
          "nullable": false,
          "primaryKey": true
        },
        {
          "name": "isSystem",
          "type": "Boolean",
          "nullable": false
        },
        {
          "name": "name",
          "type": "String",
          "nullable": false
        },
        {
          "name": "updatedAt",
          "type": "Timestamp",
          "nullable": false
        }
      ],
      "resolvers": [
        {
          "name": "permissions",
          "resolver": "db.from(\"Permission\")\n  .where(\n    inOp(\"id\", \n        db.from(\"RolePermission\")\n            .where(eq(\"roleId\", this.id))\n            .list()\n            .values('permissionId')\n    )\n)\n .list()"
        },
        {
          "name": "rolePermissions",
          "resolver": "db.from(\"RolePermission\")\n .where(eq(\"roleId\", this.id))\n .list()"
        }
      ]
    },
    {
      "name": "RolePermission",
      "fields": [
        {
          "name": "createdAt",
          "type": "Timestamp",
          "nullable": false
        },
        {
          "name": "id",
          "type": "String",
          "nullable": false,
          "primaryKey": true
        },
        {
          "name": "permissionId",
          "type": "String",
          "nullable": false
        },
        {
          "name": "roleId",
          "type": "String",
          "nullable": false
        }
      ],
      "resolvers": [
        {
          "name": "permission",
          "resolver": "db.from(\"Permission\")\n .where(eq(\"id\", this.permissionId))\n .firstOrNull()"
        },
        {
          "name": "role",
          "resolver": "db.from(\"Role\")\n .where(eq(\"id\", this.roleId))\n .firstOrNull()"
        }
      ]
    },
    {
      "name": "User",
      "fields": [
        {
          "name": "createdAt",
          "type": "Timestamp",
          "nullable": false
        },
        {
          "name": "deletedAt",
          "type": "Timestamp",
          "nullable": false
        },
        {
          "name": "email",
          "type": "String",
          "nullable": false
        },
        {
          "name": "id",
          "type": "String",
          "nullable": false,
          "primaryKey": true
        },
        {
          "name": "isActive",
          "type": "Boolean",
          "nullable": false
        },
        {
          "name": "lastLoginAt",
          "type": "Timestamp",
          "nullable": true
        },
        {
          "name": "updatedAt",
          "type": "Timestamp",
          "nullable": false
        },
        {
          "name": "username",
          "type": "String",
          "nullable": false
        }
      ],
      "resolvers": [
        {
          "name": "profile",
          "resolver": "db.from(\"UserProfile\")\n .where(eq(\"userId\", this.id))\n .firstOrNull()"
        },
        {
          "name": "roles",
          "resolver": "db.from(\"Role\")\n  .where(\n    inOp(\"id\", \n        db.from(\"UserRole\")\n            .where(eq(\"userId\", this.id))\n            .list()\n            .values('roleId')\n    )\n)\n .list()"
        },
        {
          "name": "userRoles",
          "resolver": "db.from(\"UserRole\")\n  .where(eq(\"userId\", this.id))\n  .list()"
        }
      ]
    },
    {
      "name": "UserProfile",
      "fields": [
        {
          "name": "address",
          "type": "EmbeddedObject",
          "nullable": false
        },
        {
          "name": "age",
          "type": "Int",
          "nullable": true
        },
        {
          "name": "avatarUrl",
          "type": "String",
          "nullable": false
        },
        {
          "name": "bio",
          "type": "String",
          "nullable": true
        },
        {
          "name": "createdAt",
          "type": "Timestamp",
          "nullable": false
        },
        {
          "name": "deletedAt",
          "type": "Timestamp",
          "nullable": false
        },
        {
          "name": "firstName",
          "type": "String",
          "nullable": false
        },
        {
          "name": "id",
          "type": "String",
          "nullable": false,
          "primaryKey": true
        },
        {
          "name": "lastName",
          "type": "String",
          "nullable": false
        },
        {
          "name": "phone",
          "type": "String",
          "nullable": false
        },
        {
          "name": "updatedAt",
          "type": "Timestamp",
          "nullable": true
        },
        {
          "name": "userId",
          "type": "String",
          "nullable": false
        }
      ]
    },
    {
      "name": "UserRole",
      "fields": [
        {
          "name": "createdAt",
          "type": "Timestamp",
          "nullable": false
        },
        {
          "name": "id",
          "type": "String",
          "nullable": false,
          "primaryKey": true
        },
        {
          "name": "roleId",
          "type": "String",
          "nullable": false
        },
        {
          "name": "userId",
          "type": "String",
          "nullable": false
        }
      ],
      "resolvers": [
        {
          "name": "role",
          "resolver": "db.from(\"Role\")\n .where(eq(\"id\", this.roleId))\n .list()"
        }
      ]
    }
  ]
}