{
  "databaseId": "bbabca0e-82ce-11f0-0000-a2ce78b61b6a",
  "revisionDescription": "test",
  "entities": [
    {
      "name": "User",
      "identifier": {
        "name": "id",
        "generator": "UUID",
        "type": "String"
      },
      "partition": "",
      "attributes": [
        {
          "name": "id",
          "type": "String",
          "maxSize": 36,
          "isNullable": false
        },
         {
          "name": "asdf",
          "type": "String",
          "maxSize": 36,
          "isNullable": false
        },
        {
          "name": "username",
          "type": "String",
          "maxSize": 64,
          "isNullable": false
        },
        {
          "name": "email",
          "type": "String",
          "maxSize": 255,
          "isNullable": false
        },
        {
          "name": "isActive",
          "type": "Boolean",
          "isNullable": false
        },
        {
          "name": "lastLoginAt",
          "type": "Timestamp",
          "isNullable": true
        },
        {
          "name": "createdAt",
          "type": "Timestamp",
          "isNullable": false
        },
        {
          "name": "updatedAt",
          "type": "Timestamp",
          "isNullable": false
        },
        {
          "name": "deletedAt",
          "type": "Timestamp",
          "isNullable": true
        }
      ],
      "indexes": [
        {
          "name": "username"
        },
        {
          "name": "email"
        },
        {
          "name": "isActive"
        }
      ],
      "resolvers": [
        {
          "name": "roles",
          "resolver": "db.from(\"Role\")\n  .where(\n    inOp(\"id\", \n        db.from(\"UserRole\")\n            .where(eq(\"userId\", this.id))\n            .list()\n            .values('roleId')\n    )\n)\n .list()"
        },
        {
          "name": "profile",
          "resolver": "db.from(\"UserProfile\")\n .where(eq(\"userId\", this.id))\n .firstOrNull()"
        },
        {
          "name": "userRoles",
          "resolver": "db.from(\"UserRole\")\n  .where(eq(\"userId\", this.id))\n  .list()"
        }
      ],
      "triggers": []
    },
    {
      "name": "UserProfile",
      "identifier": {
        "name": "id",
        "generator": "UUID",
        "type": "String"
      },
      "partition": "",
      "attributes": [
        {
          "name": "id",
          "type": "String",
          "maxSize": 36,
          "isNullable": false
        },
        {
          "name": "userId",
          "type": "String",
          "maxSize": 36,
          "isNullable": false
        },
        {
          "name": "firstName",
          "type": "String",
          "maxSize": 100,
          "isNullable": false
        },
        {
          "name": "lastName",
          "type": "String",
          "maxSize": 100,
          "isNullable": false
        },
        {
          "name": "phone",
          "type": "String",
          "maxSize": 32,
          "isNullable": true
        },
        {
          "name": "address",
          "type": "EmbeddedObject",
          "maxSize": 512,
          "isNullable": true
        },
        {
          "name": "avatarUrl",
          "type": "String",
          "maxSize": 512,
          "isNullable": true
        },
        {
          "name": "bio",
          "type": "String",
          "maxSize": 1024,
          "isNullable": true
        },
        {
          "name": "createdAt",
          "type": "Timestamp",
          "isNullable": false
        },
        {
          "name": "updatedAt",
          "type": "Timestamp",
          "isNullable": true
        },
        {
          "name": "deletedAt",
          "type": "Timestamp",
          "isNullable": true
        },
        {
          "name": "age",
          "type": "Int",
          "isNullable": true
        }
      ],
      "indexes": [
        {
          "name": "userId"
        }
      ],
      "resolvers": [],
      "triggers": []
    },
    {
      "name": "Role",
      "identifier": {
        "name": "id",
        "generator": "UUID",
        "type": "String"
      },
      "partition": "",
      "attributes": [
        {
          "name": "id",
          "type": "String",
          "maxSize": 36,
          "isNullable": false
        },
        {
          "name": "name",
          "type": "String",
          "maxSize": 64,
          "isNullable": false
        },
        {
          "name": "description",
          "type": "String",
          "maxSize": 512,
          "isNullable": true
        },
        {
          "name": "isSystem",
          "type": "Boolean",
          "isNullable": false
        },
        {
          "name": "createdAt",
          "type": "Timestamp",
          "isNullable": false
        },
        {
          "name": "updatedAt",
          "type": "Timestamp",
          "isNullable": false
        },
        {
          "name": "deletedAt",
          "type": "Timestamp",
          "isNullable": true
        }
      ],
      "indexes": [
        {
          "name": "name"
        },
        {
          "name": "isSystem"
        }
      ],
      "resolvers": [
        {
          "name": "permissions",
          "resolver": "db.from(\"Permission\")\n  .where(\n    inOp(\"id\", \n        db.from(\"RolePermission\")\n            .where(eq(\"roleId\", this.id))\n            .list()\n            .values('permissionId')\n    )\n)\n .list()"
        },
        {
          "name": "rolePermissions",
          "resolver": "db.from(\"RolePermission\")\n .where(eq(\"roleId\", this.id))\n .list()"
        }
      ],
      "triggers": []
    },
    {
      "name": "Permission",
      "identifier": {
        "name": "id",
        "generator": "UUID",
        "type": "String"
      },
      "partition": "",
      "attributes": [
        {
          "name": "id",
          "type": "String",
          "maxSize": 36,
          "isNullable": false
        },
        {
          "name": "name",
          "type": "String",
          "maxSize": 96,
          "isNullable": false
        },
        {
          "name": "description",
          "type": "String",
          "maxSize": 512,
          "isNullable": true
        },
        {
          "name": "createdAt",
          "type": "Timestamp",
          "isNullable": false
        },
        {
          "name": "updatedAt",
          "type": "Timestamp",
          "isNullable": false
        },
        {
          "name": "deletedAt",
          "type": "Timestamp",
          "isNullable": true
        }
      ],
      "indexes": [
        {
          "name": "name"
        }
      ],
      "resolvers": [],
      "triggers": []
    },
    {
      "name": "UserRole",
      "identifier": {
        "name": "id",
        "generator": "UUID",
        "type": "String"
      },
      "partition": "",
      "attributes": [
        {
          "name": "id",
          "type": "String",
          "maxSize": 36,
          "isNullable": false
        },
        {
          "name": "userId",
          "type": "String",
          "maxSize": 36,
          "isNullable": false
        },
        {
          "name": "roleId",
          "type": "String",
          "maxSize": 36,
          "isNullable": false
        },
        {
          "name": "createdAt",
          "type": "Timestamp",
          "isNullable": false
        }
      ],
      "indexes": [
        {
          "name": "userId"
        },
        {
          "name": "roleId"
        }
      ],
      "resolvers": [
        {
          "name": "role",
          "resolver": "db.from(\"Role\")\n .where(eq(\"id\", this.roleId))\n .list()"
        }
      ],
      "triggers": []
    },
    {
      "name": "RolePermission",
      "identifier": {
        "name": "id",
        "generator": "UUID",
        "type": "String"
      },
      "partition": "",
      "attributes": [
        {
          "name": "id",
          "type": "String",
          "maxSize": 36,
          "isNullable": false
        },
        {
          "name": "roleId",
          "type": "String",
          "maxSize": 36,
          "isNullable": false
        },
        {
          "name": "permissionId",
          "type": "String",
          "maxSize": 36,
          "isNullable": false
        },
        {
          "name": "createdAt",
          "type": "Timestamp",
          "isNullable": false
        }
      ],
      "indexes": [
        {
          "name": "roleId"
        },
        {
          "name": "permissionId"
        }
      ],
      "resolvers": [
        {
          "name": "permission",
          "resolver": "db.from(\"Permission\")\n .where(eq(\"id\", this.permissionId))\n .firstOrNull()"
        },
        {
          "name": "role",
          "resolver": "db.from(\"Role\")\n .where(eq(\"id\", this.roleId))\n .firstOrNull()"
        }
      ],
      "triggers": []
    },
    {
      "name": "AuditLog",
      "identifier": {
        "name": "id",
        "generator": "UUID",
        "type": "String"
      },
      "partition": "tenantId",
      "attributes": [
        {
          "name": "id",
          "type": "String",
          "maxSize": 36,
          "isNullable": false
        },
        {
          "name": "dateTime",
          "type": "Timestamp",
          "isNullable": false
        },
        {
          "name": "action",
          "type": "String",
          "maxSize": 128,
          "isNullable": true
        },
        {
          "name": "status",
          "type": "String",
          "maxSize": 64,
          "isNullable": true
        },
        {
          "name": "actorId",
          "type": "String",
          "maxSize": 36,
          "isNullable": true
        },
        {
          "name": "tenantId",
          "type": "String",
          "maxSize": 36,
          "isNullable": true
        },
        {
          "name": "targetId",
          "type": "String",
          "maxSize": 36,
          "isNullable": true
        },
        {
          "name": "resource",
          "type": "String",
          "maxSize": 255,
          "isNullable": true
        },
        {
          "name": "requestId",
          "type": "String",
          "maxSize": 36,
          "isNullable": true
        },
        {
          "name": "errorCode",
          "type": "String",
          "maxSize": 64,
          "isNullable": true
        },
        {
          "name": "errorMessage",
          "type": "String",
          "maxSize": 512,
          "isNullable": true
        },
        {
          "name": "changes",
          "type": "EmbeddedObject",
          "maxSize": 512,
          "isNullable": true
        },
        {
          "name": "metadata",
          "type": "EmbeddedObject",
          "maxSize": 512,
          "isNullable": true
        }
      ],
      "indexes": [
        {
          "name": "errorCode"
        },
        {
          "name": "resource"
        },
        {
          "name": "actorId"
        },
        {
          "name": "action"
        },
        {
          "name": "status"
        },
        {
          "name": "dateTime"
        }
      ],
      "resolvers": [],
      "triggers": []
    }
  ]
}
